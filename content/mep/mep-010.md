MEP | 10
--- | ---
Title | Extended Public Key Support for Credentials
Status | Draft
Created | 2015-02-04
Author | Justus Ranvier

# Support extended public keys as signing keys

## Abstract

Credentials in OT currently support one signing key per credential.

Several future applications would benefit from the ability to deterministically derive new keypairs.

This MEP describes a way support can be added to credentials such that heirarchical deterministic derivation of keypair is possible.

See also:

* https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki
* https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki

## Current status

[Credentials](../doctypes/credentials.md) in OT each have three keys: `A` (authentication), `E` (encryption) and `S` (signing).

These keys do not contain the chain code information needed to be HD-capable.

## Drawbacks

Without HD key generation, it is not possible to deterministically create Bitmessage addresses for the audit stream, or mint keys for cash instruments. 

This means a compromised or malicious notary can conduct partitioning attacks to break the security of an audit, or to deanonymize cash users.

## Enhancement

Add three new key types to OT credentials:  `AX` (extended authentication key), `EX` (extended encryption key), and `SX` (extended signing key).

The public (private) version of the credential would add a new element to the `publicInfo` (`privateInfo`) objects, `chaincode`, which will follow the `publicKey` (`privateKey`) element.

Chaincodes codes are 256 bit integers and are identical for public and private keys.

In any case where it's necessary to take the hash of an extended key, the extended key should first be serialized per [BIP-32](https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki#serialization-format)

Extended keys are only valid for ECC.

All current usages of authentication, encryption, and signing keys in OT should use the 0th child of the extended key.

Deterministic derivations for other child keys will be defined in future MEPs that introduce the features that depend on deterministic keys.

## Impact

The 0th child of `AX`, `EX`, and `SX` keys can replace their non-extended counterparts for all current usages within OT.

Deploying extended keys will make future enhancements which require HD key derivation possible without requiring users to generate new credentials.